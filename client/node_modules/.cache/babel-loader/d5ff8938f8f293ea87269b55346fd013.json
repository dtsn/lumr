{"ast":null,"code":"var _jsxFileName = \"/Users/danisaxi/Repositories/lumr/client/src/components/welcome.js\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst HUB_STATUS_LOADING = 'loading';\nconst HUB_STATUS_CONNECTED = 'connected';\nconst HUB_STATUS_ERROR = 'error';\nconst LIGHTS_STATUS_LOADING = 'loading';\nconst LIGHTS_STATUS_ERROR = 'error';\n\nclass Welcome extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hub: false,\n      lights: false,\n      lightStatus: false,\n      selectedLights: []\n    };\n  }\n\n  componentDidMount() {\n    // if we have the config but not the lights restart light discovery\n    if (this.props.config && !this.props.config.lights) {\n      this.setState({\n        hub: HUB_STATUS_CONNECTED\n      });\n      this.discoverLights();\n    }\n  }\n\n  discoverHub() {\n    this.setState({\n      hub: HUB_STATUS_LOADING\n    });\n    fetch('/api/discover/hubs').then(res => {\n      if (res.status === 200) {\n        this.setState({\n          hub: HUB_STATUS_CONNECTED\n        });\n        this.discoverLights();\n      } else {\n        this.setState({\n          hub: HUB_STATUS_ERROR\n        });\n      }\n    });\n  }\n\n  discoverLights() {\n    this.setState({\n      lightStatus: LIGHTS_STATUS_LOADING\n    });\n    fetch('/api/lights/list').then(res => res.json()).then(json => {\n      if (json && json.length > 0) {\n        this.setState({\n          lights: json\n        });\n      }\n    }).catch(e => {\n      this.setState({\n        lightStatus: LIGHTS_STATUS_ERROR\n      });\n    });\n  }\n\n  saveLights() {\n    fetch('/api/lights/add', {\n      method: 'POST',\n      body: JSON.stringify({\n        lights: this.state.selectedLights\n      })\n    });\n  }\n\n  render() {\n    let lights = [];\n    console.log(this.state);\n\n    if (this.state.lights.length > 0) {\n      this.state.lights.forEach(light => {\n        lights.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            id: `light-${light._data.id}`,\n            name: `light-${light._data.id}`,\n            checked: this.state.selectedLights.indexOf(light._data.id) !== -1,\n            onChange: () => {\n              this.setState({\n                selectedLights: [...this.state.selectedLights, light._data.id]\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            for: `light-${light._data.id}`,\n            children: light._data.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 6\n        }, this));\n      });\n      console.log(this.state.lights);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"welcome\",\n      children: [!this.state.hub && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Let's get started, we are going to need to find your Hue hub to authenticate with it.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.discoverHub.bind(this),\n          children: \"Let's Go\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true), this.state.hub === HUB_STATUS_LOADING && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Searching...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please push the button on the hub you want to use.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true), this.state.hub === HUB_STATUS_ERROR && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Oops something went wrong, try again prehaps you weren't quick enough?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.discoverHub.bind(this),\n          children: \"Let's Go\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true), this.state.lightStatus === LIGHTS_STATUS_LOADING && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Wahoo! We are connected, just fetching your lights\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 6\n      }, this), this.state.lights.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"We've found \", this.state.lights.length, \" lights, please select the ones you would like to use:\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 7\n        }, this), lights, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.saveLights.bind(this),\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 4\n    }, this);\n  }\n\n}\n\nexport default Welcome;","map":{"version":3,"sources":["/Users/danisaxi/Repositories/lumr/client/src/components/welcome.js"],"names":["React","HUB_STATUS_LOADING","HUB_STATUS_CONNECTED","HUB_STATUS_ERROR","LIGHTS_STATUS_LOADING","LIGHTS_STATUS_ERROR","Welcome","Component","constructor","props","state","hub","lights","lightStatus","selectedLights","componentDidMount","config","setState","discoverLights","discoverHub","fetch","then","res","status","json","length","catch","e","saveLights","method","body","JSON","stringify","render","console","log","forEach","light","push","_data","id","indexOf","name","bind"],"mappings":"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","sourcesContent":["import React from 'react';\n\nconst HUB_STATUS_LOADING = 'loading';\nconst HUB_STATUS_CONNECTED = 'connected';\nconst HUB_STATUS_ERROR = 'error';\n\nconst LIGHTS_STATUS_LOADING = 'loading';\nconst LIGHTS_STATUS_ERROR = 'error';\n\nclass Welcome extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\thub: false,\n\t\t\tlights: false,\n\t\t\tlightStatus: false,\n            selectedLights: [],\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\t// if we have the config but not the lights restart light discovery\n\t\tif (this.props.config && !this.props.config.lights) {\n\t\t\tthis.setState({\n\t\t\t\thub: HUB_STATUS_CONNECTED,\n\t\t\t});\n\t\t\tthis.discoverLights();\n\t\t}\n\t}\n\n\tdiscoverHub() {\n\t\tthis.setState({\n\t\t\thub: HUB_STATUS_LOADING,\n\t\t});\n\t\tfetch('/api/discover/hubs').then((res) => {\n\t\t\tif (res.status === 200) {\n\t\t\t\tthis.setState({\n\t\t\t\t\thub: HUB_STATUS_CONNECTED,\n\t\t\t\t});\n\t\t\t\tthis.discoverLights();\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\thub: HUB_STATUS_ERROR,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tdiscoverLights() {\n\t\tthis.setState({\n\t\t\tlightStatus: LIGHTS_STATUS_LOADING,\n\t\t});\n\t\tfetch('/api/lights/list')\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tif (json && json.length > 0) {\n\t\t\t\t\tthis.setState({ lights: json });\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tthis.setState({ lightStatus: LIGHTS_STATUS_ERROR });\n\t\t\t});\n\t}\n\n\tsaveLights() {\n        fetch('/api/lights/add', {\n            method: 'POST',\n            body: JSON.stringify({\n                lights: this.state.selectedLights\n            })\n        })\n    }\n\n\trender() {\n\t\tlet lights = [];\n\n\t\tconsole.log(this.state);\n\t\tif (this.state.lights.length > 0) {\n\t\t\tthis.state.lights.forEach((light) => {\n\t\t\t\tlights.push(\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n                            type='checkbox'\n                            id={`light-${light._data.id}`}\n                            name={`light-${light._data.id}`}\n                            checked={this.state.selectedLights.indexOf(light._data.id) !== -1}\n                            onChange={() => {\n                                this.setState({\n                                    selectedLights: [...this.state.selectedLights, light._data.id]\n                                })\n                            }}\n                        />\n\t\t\t\t\t\t<label for={`light-${light._data.id}`}>{light._data.name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tconsole.log(this.state.lights);\n\t\t}\n\n\t\treturn (\n\t\t\t<section className='welcome'>\n\t\t\t\t{!this.state.hub && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<p>Let's get started, we are going to need to find your Hue hub to authenticate with it.</p>\n\t\t\t\t\t\t<button onClick={this.discoverHub.bind(this)}>Let's Go</button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\n\t\t\t\t{this.state.hub === HUB_STATUS_LOADING && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<p>Searching...</p>\n\t\t\t\t\t\t<p>Please push the button on the hub you want to use.</p>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\n\t\t\t\t{this.state.hub === HUB_STATUS_ERROR && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<p>Oops something went wrong, try again prehaps you weren't quick enough?</p>\n\t\t\t\t\t\t<button onClick={this.discoverHub.bind(this)}>Let's Go</button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\n\t\t\t\t{this.state.lightStatus === LIGHTS_STATUS_LOADING && (\n\t\t\t\t\t<p>Wahoo! We are connected, just fetching your lights</p>\n\t\t\t\t)}\n\n\t\t\t\t{this.state.lights.length > 0 && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWe've found {this.state.lights.length} lights, please select the ones you would like to use:\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{lights}\n\t\t\t\t\t\t<button onClick={this.saveLights.bind(this)}>Save</button>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</section>\n\t\t);\n\t}\n}\n\nexport default Welcome;\n"]},"metadata":{},"sourceType":"module"}